<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>TIMEMARK PRICING</title>

<style>
body{
  margin:0;
  font-family:Arial;
  background:linear-gradient(135deg,#0b1d3a,#4a00e0,#8e2de2);
  min-height:100vh;
  color:#fff;
}
.header{text-align:center;padding:30px 10px;}
.container{
  max-width:900px;margin:auto;
  display:flex;gap:20px;flex-wrap:wrap;
  justify-content:center;
}
.card{
  width:260px;border-radius:18px;padding:22px;
  backdrop-filter:blur(16px);
  background:rgba(255,255,255,0.08);
  box-shadow:0 20px 40px rgba(0,0,0,.4);
  text-align:center;
  transition:.3s;
}
.card:hover{transform:translateY(-8px);}
.basic{border:2px solid #00e676;}
.pro{border:2px solid #00b0ff;}
.premium{border:2px solid #ff00ff;}
.price{font-size:18px;margin:10px 0;line-height:1.8;}
button{
  width:100%;padding:12px;border:none;
  border-radius:10px;font-weight:bold;
  cursor:pointer;
  background:linear-gradient(135deg,#ff6a00,#ff9800);
  color:#fff;
}
.footer{text-align:center;margin-top:30px;opacity:.7;}
</style>
</head>

<body>

<div id="qrPopup" style="position:fixed;inset:0;background:rgba(0,0,0,.75);
display:none;align-items:center;justify-content:center;z-index:99999;">
  <div style="background:#111;padding:20px;border-radius:14px;text-align:center;width:300px;">
    <h3>Qu√©t QR ƒë·ªÉ thanh to√°n</h3>
    <img id="qrImg" src="" style="width:220px;border-radius:10px;margin:12px 0;">
    <div id="loadingText">‚è≥ ƒêang ch·ªù thanh to√°n...</div>
  </div>
</div>

<div class="header">
  <h1>üöÄ TIMEMARK PREMIUM</h1>
  <p>Ch·ªçn g√≥i b·∫£n quy·ªÅn ph√π h·ª£p</p>
</div>

<div class="container" id="pricing"></div>

<div class="footer">M·ªói key d√πng cho 1 thi·∫øt b·ªã</div>

<script>

/* =========================
   ‚≠ê CH·ªà S·ª¨A GI√Å ·ªû ƒê√ÇY
========================= */
const priceMap = {
  basic1: 39000,
  basic7: 199000,
  pro1: 699000,
  pro3: 1399000,
  pre6: 2199000,
  lifetime: 3499000
};

/* =========================
   ‚≠ê DATA PLAN (KH√îNG C·∫¶N S·ª¨A GI√Å)
========================= */
const plans = [
 {id:"basic1", title:"‚ö° 1 NG√ÄY", cls:"basic"},
 {id:"basic7", title:"üå± 7 NG√ÄY", cls:"basic"},
 {id:"pro1", title:"‚≠ê 1 TH√ÅNG", cls:"pro"},
 {id:"pro3", title:"üî• 3 TH√ÅNG", cls:"pro"},
 {id:"pre6", title:"üöÄ 6 TH√ÅNG", cls:"premium"},
 {id:"lifetime", title:"üíé Vƒ®NH VI·ªÑN", cls:"premium"}
];

/* =========================
   ‚≠ê AUTO RENDER CARD + GI√Å
========================= */
const box = document.getElementById("pricing");

plans.forEach(p=>{

  const priceText = priceMap[p.id].toLocaleString("vi-VN")+"ƒë";

  box.innerHTML += `
    <div class="card ${p.cls}">
      <h3>${p.title}</h3>
      <div class="price">${priceText}</div>
      <button onclick="buy('${p.id}')">MUA NGAY</button>
    </div>
  `;
});


/* =========================
   ‚≠ê CHECK PAID REALTIME
========================= */
let checkTimer=null;

function startChecking(email){

  if(checkTimer) clearInterval(checkTimer);

  checkTimer=setInterval(()=>{

    fetch("https://script.google.com/macros/s/AKfycbwDRIc7_SZC2nx1TlYRU-taklWN57lDF9aXLHt2LE3MrLDEu-7Q0inQQlvYd6MKplhw9Q/exec",{
      method:"POST",
      body:JSON.stringify({action:"checkPaid",email})
    })
    .then(r=>r.json())
    .then(res=>{
      if(res.paid){
        clearInterval(checkTimer);
        document.getElementById("qrPopup").style.display="none";
        alert("üéâ Thanh to√°n th√†nh c√¥ng! KEY ƒë√£ g·ª≠i v·ªÅ email.");
      }
    });

  },3000);
}


/* =========================
   ‚≠ê BUY
========================= */
function buy(plan){

  const email = prompt("Nh·∫≠p Gmail ƒë·ªÉ nh·∫≠n KEY:");

  if(!email || !email.includes("@")){
    alert("Email kh√¥ng h·ª£p l·ªá");
    return;
  }

  const price = priceMap[plan];
  const orderId = plan.toUpperCase();

  const qrLink =
  "https://img.vietqr.io/image/970415-104882732682-compact2.png?amount="
  +price+
  "&addInfo="+encodeURIComponent(orderId)+
  "&accountName="+encodeURIComponent("TIMEMARK");

  document.getElementById("qrPopup").style.display="flex";
  document.getElementById("qrImg").src=qrLink;

  fetch("https://script.google.com/macros/s/AKfycbwDRIc7_SZC2nx1TlYRU-taklWN57lDF9aXLHt2LE3MrLDEu-7Q0inQQlvYd6MKplhw9Q/exec",{
    method:"POST",
    body:JSON.stringify({action:"createPending",email})
  }).then(()=>startChecking(email));
}

</script>

</body>
</html>
